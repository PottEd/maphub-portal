/**
 * A TileOverlay that includes support for changing the transparency/opacity
 * of the overlay.
 */
maphub.AlphaOverlay=function(e){e&&maphub.TileOverlay.prototype.constructor.apply(this,[e]),this.opacity=maphub.AlphaOverlay.InitialOpacity,this.createOpacityControl(this.map.googleMap,this.opacity)},maphub.AlphaOverlay.prototype=new maphub.TileOverlay,maphub.AlphaOverlay.constructor=maphub.AlphaOverlay,maphub.AlphaOverlay.SliderWidth=57,maphub.AlphaOverlay.InitialOpacity=75,maphub.AlphaOverlay.SliderImageURL="/assets/opacity-slider.png",maphub.AlphaOverlay.prototype.getTile=function(e,t,n){var r=maphub.TileOverlay.prototype.getTile.apply(this,[e,t,n]);return this.setObjectOpacity(r,this.opacity),r},maphub.AlphaOverlay.prototype.createOpacityControl=function(e,t){var n=document.createElement("DIV");n.setAttribute("style","margin:5px;overflow-x:hidden;overflow-y:hidden;background:url("+maphub.AlphaOverlay.SliderImageURL+") no-repeat;width:71px;height:21px;cursor:pointer;");var r=document.createElement("DIV");r.setAttribute("style","padding:0;margin:0;overflow-x:hidden;overflow-y:hidden;background:url("+maphub.AlphaOverlay.SliderImageURL+") no-repeat -71px 0;width:14px;height:21px;"),n.appendChild(r);var i=new ExtDraggableObject(r,{restrictY:!0,container:n}),s=this;google.maps.event.addListener(i,"dragend",function(){s.setOpacity(i.valueX())}),google.maps.event.addDomListener(n,"click",function(e){var t=s.findPosLeft(this),n=e.pageX-t-5;i.setValueX(n),s.setOpacity(n)}),this.map.googleMap.controls[google.maps.ControlPosition.TOP_RIGHT].push(n);var o=maphub.AlphaOverlay.SliderWidth/(100/this.opacity);i.setValueX(o),this.setOpacity(o)},maphub.AlphaOverlay.prototype.setOpacity=function(e){var t=100/maphub.AlphaOverlay.SliderWidth*e;t<0&&(t=0),this.opacity=t;for(var n in this.tiles)console.log("Changing tile "+n),this.setObjectOpacity(this.tiles[n],t)},maphub.AlphaOverlay.prototype.setObjectOpacity=function(e,t){typeof e.style.filter=="string"&&(e.style.filter="alpha(opacity:"+t+")"),typeof e.style.KHTMLOpacity=="string"&&(e.style.KHTMLOpacity=t/100),typeof e.style.MozOpacity=="string"&&(e.style.MozOpacity=t/100),typeof e.style.opacity=="string"&&(e.style.opacity=t/100)},maphub.AlphaOverlay.prototype.findPosLeft=function(e){var t=0;if(e.offsetParent){do t+=e.offsetLeft;while(e=e.offsetParent);return t}return undefined},maphub.AlphaOverlay.prototype.toString=function(){return"AlphaOverlay<map="+this.map.id+", opacity="+this.opacity+", tileSize="+this.tileSize+">"};